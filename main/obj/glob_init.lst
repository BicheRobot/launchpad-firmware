
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\main\obj\glob_init.o:     file format elf32-littlearm
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\main\obj\glob_init.o


Disassembly of section .text.glob_init_clocks:

00000000 <glob_init_clocks>:
glob_init_clocks():
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:25
	// HCLK --> APB1 Prescaler /2 -->  =PCLK1 @ 24MHz (limit imposed by datasheet)
	// HCLK --> APB2 Prescaler /2 -->  =PCLK2 @ 24MHz (limit imposed by datasheet)
	// HCLK --> ADC Prescaler /2 --> =ADCCLK @ 24MHz (limit imposed by reference manual)

	// turn on external clock and keep on internal clock (as the FLASH controller runs off this)
	poke(RCC_CR,(1<<16)+1);
   0:	4b19      	ldr	r3, [pc, #100]	; (68 <glob_init_clocks+0x68>)
   2:	f04f 1201 	mov.w	r2, #65537	; 0x10001
   6:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:27
	// wait for external clock to stabilise
	while ( (peek(RCC_CR) & (1<<17)) == 0 ) { __asm("nop"); }
   8:	681b      	ldr	r3, [r3, #0]
   a:	f413 3f00 	tst.w	r3, #131072	; 0x20000
   e:	d105      	bne.n	1c <glob_init_clocks+0x1c>
  10:	4a15      	ldr	r2, [pc, #84]	; (68 <glob_init_clocks+0x68>)
  12:	bf00      	nop
  14:	6813      	ldr	r3, [r2, #0]
  16:	f413 3f00 	tst.w	r3, #131072	; 0x20000
  1a:	d0fa      	beq.n	12 <glob_init_clocks+0x12>
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:30

	// set up peripheral clock division
	poke(RCC_CFGR,0x592400);
  1c:	4a13      	ldr	r2, [pc, #76]	; (6c <glob_init_clocks+0x6c>)
  1e:	4b14      	ldr	r3, [pc, #80]	; (70 <glob_init_clocks+0x70>)
  20:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:31
	poke(FLASH_ACR,0x11);	 // one wait state; prefetch buffers on
  22:	f04f 0211 	mov.w	r2, #17
  26:	f503 637e 	add.w	r3, r3, #4064	; 0xfe0
  2a:	f103 031c 	add.w	r3, r3, #28
  2e:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:33
	// turn on PLL
	poke_set(RCC_CR,(1<<24));
  30:	f5a3 5380 	sub.w	r3, r3, #4096	; 0x1000
  34:	681a      	ldr	r2, [r3, #0]
  36:	f042 7280 	orr.w	r2, r2, #16777216	; 0x1000000
  3a:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:35
	// wait for PLL to stabilise
	while ( (peek(RCC_CR) & (1<<25)) == 0 ) { __asm("nop"); }
  3c:	681b      	ldr	r3, [r3, #0]
  3e:	f013 7f00 	tst.w	r3, #33554432	; 0x2000000
  42:	d105      	bne.n	50 <glob_init_clocks+0x50>
  44:	4a08      	ldr	r2, [pc, #32]	; (68 <glob_init_clocks+0x68>)
  46:	bf00      	nop
  48:	6813      	ldr	r3, [r2, #0]
  4a:	f013 7f00 	tst.w	r3, #33554432	; 0x2000000
  4e:	d0fa      	beq.n	46 <glob_init_clocks+0x46>
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:38

	// select PLL clock
	poke(RCC_CFGR,0x59240A);
  50:	4a08      	ldr	r2, [pc, #32]	; (74 <glob_init_clocks+0x74>)
  52:	4b07      	ldr	r3, [pc, #28]	; (70 <glob_init_clocks+0x70>)
  54:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:40
	// wait for it all to stabilise
	__asm("nop\r\n nop\r\n nop\r\n nop\r\n");
  56:	bf00      	nop
  58:	bf00      	nop
  5a:	bf00      	nop
  5c:	bf00      	nop
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:41
	__asm("nop\r\n nop\r\n nop\r\n nop\r\n");
  5e:	bf00      	nop
  60:	bf00      	nop
  62:	bf00      	nop
  64:	bf00      	nop
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:42
}
  66:	4770      	bx	lr
  68:	40021000 	.word	0x40021000
  6c:	00592400 	.word	0x00592400
  70:	40021004 	.word	0x40021004
  74:	0059240a 	.word	0x0059240a

Disassembly of section .text.glob_init_gpios:

00000000 <glob_init_gpios>:
glob_init_gpios():
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:50
//

void glob_init_gpios()
{
	// turn on alternate function, GPIOA, GPIOB, GPIOC, GPIOD, ADC.
	poke(RCC_APB2ENR, 0x33D);
   0:	f240 323d 	movw	r2, #829	; 0x33d
   4:	4b18      	ldr	r3, [pc, #96]	; (68 <glob_init_gpios+0x68>)
   6:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:69
	//	A2  : unused           	: output pp
	//	A1  : unused          	: output pp
	//	A0  : unused           	: output pp

	// set up GPIOA
    poke(GPIOA_ODR, 0x0); // pull down the USB pullup
   8:	f04f 0200 	mov.w	r2, #0
   c:	f5a3 3384 	sub.w	r3, r3, #67584	; 0x10800
  10:	f1a3 030c 	sub.w	r3, r3, #12
  14:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:70
	poke(GPIOA_CRH, 0x44444111);
  16:	4a15      	ldr	r2, [pc, #84]	; (6c <glob_init_gpios+0x6c>)
  18:	f1a3 0308 	sub.w	r3, r3, #8
  1c:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:71
	poke(GPIOA_CRL, 0x14911111);
  1e:	f102 4250 	add.w	r2, r2, #3489660928	; 0xd0000000
  22:	f502 0298 	add.w	r2, r2, #4980736	; 0x4c0000
  26:	f502 4250 	add.w	r2, r2, #53248	; 0xd000
  2a:	f1a3 0304 	sub.w	r3, r3, #4
  2e:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:91
	//	B2  : COL2       		: output pp
	//	B1  : COL1             	: output pp
	//	B0  : COL0              : output pp

	// set up GPIOB
    poke(GPIOB_ODR, 0x7); // pull up the column drivers
  30:	f04f 0207 	mov.w	r2, #7
  34:	f503 6380 	add.w	r3, r3, #1024	; 0x400
  38:	f103 030c 	add.w	r3, r3, #12
  3c:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:92
	poke(GPIOB_CRH, 0x91911111);
  3e:	4a0c      	ldr	r2, [pc, #48]	; (70 <glob_init_gpios+0x70>)
  40:	f1a3 0308 	sub.w	r3, r3, #8
  44:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:93
	poke(GPIOB_CRL, 0x11144111);
  46:	f102 42fe 	add.w	r2, r2, #2130706432	; 0x7f000000
  4a:	f502 0203 	add.w	r2, r2, #8585216	; 0x830000
  4e:	f502 5240 	add.w	r2, r2, #12288	; 0x3000
  52:	f1a3 0304 	sub.w	r3, r3, #4
  56:	601a      	str	r2, [r3, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:101
	//	C15 : unused   			: output pp
	//	C14 : unused			: output pp
	//	C13 : unused			: output pp

	// set up GPIOC
	poke(GPIOC_CRH, 0x11111111);
  58:	f04f 3311 	mov.w	r3, #286331153	; 0x11111111
  5c:	4a05      	ldr	r2, [pc, #20]	; (74 <glob_init_gpios+0x74>)
  5e:	6013      	str	r3, [r2, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:102
	poke(GPIOC_CRL, 0x11111111);
  60:	f1a2 0204 	sub.w	r2, r2, #4
  64:	6013      	str	r3, [r2, #0]
C:\Users\rosschisholm\Documents\Work\Sonar Launchpad\common/glob_init.c:113
	// 8 = IN PUPD
	// 1 = OUT PP (<=10MHz)
	// 5 = OUT OD (<=10MHz)
	// 9 = AF PP  (<=10MHz)
	// D = AF OD  (<=10MHz)
}
  66:	4770      	bx	lr
  68:	40021018 	.word	0x40021018
  6c:	44444111 	.word	0x44444111
  70:	91911111 	.word	0x91911111
  74:	40011004 	.word	0x40011004
